<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Lineup.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ootp-ai</a> &gt; <a href="index.source.html" class="el_package">com.ljs.ootp.ai.selection.lineup</a> &gt; <span class="el_source">Lineup.java</span></div><h1>Lineup.java</h1><pre class="source lang-java linenums">package com.ljs.ootp.ai.selection.lineup;

import com.ljs.ootp.ai.io.Printable;
import com.ljs.ootp.ai.player.Player;
import com.ljs.ootp.ai.player.ratings.BattingRatings;
import com.ljs.ootp.ai.player.ratings.Position;
import com.ljs.ootp.ai.stats.BattingStats;
import com.ljs.ootp.ai.stats.SplitStats;
import com.ljs.ootp.ai.stats.TeamStats;

import java.io.PrintWriter;

import java.util.Iterator;
import java.util.List;
import java.util.Set;

import com.google.common.base.Function;
import com.google.common.base.Preconditions;
import com.google.common.collect.ImmutableList;
import com.google.common.collect.ImmutableSet;
import com.google.common.collect.Lists;

public class Lineup implements Iterable&lt;Lineup.Entry&gt;, Printable {

    private Defense defense;
    private List&lt;Player&gt; order;

    public static final class Entry {

        private final Position position;
        private final Player player;

<span class="nc" id="L33">        public Entry(Position position, Player player) {</span>
<span class="nc" id="L34">            this.position = position;</span>
<span class="nc" id="L35">            this.player = player;</span>
<span class="nc" id="L36">        }</span>

        public Player getPlayer() {
<span class="nc" id="L39">            return player;</span>
        }

        public String getPosition() {
<span class="nc" id="L43">            return position.getAbbreviation();</span>
        }

        public Position getPositionEnum() {
<span class="nc" id="L47">            return position;</span>
        }

        public String getShortName() {
<span class="nc bnc" id="L51" title="All 2 branches missed.">            return player == null ? &quot;&quot; : player.getShortName();</span>
        }

        public String format(String fmt) {
<span class="nc" id="L55">            return String.format(</span>
                fmt,
<span class="nc bnc" id="L57" title="All 2 branches missed.">                getPosition(),</span>
<span class="nc" id="L58">                player == null ? &quot;&quot; : player.getBattingHand().getCode(),</span>
<span class="nc" id="L59">                getShortName());</span>
        }

    }

<span class="nc" id="L64">    public static enum VsHand {</span>

<span class="nc" id="L66">        VS_LHP {</span>
            public BattingStats getStats(TeamStats predictions, Player p) {
<span class="nc" id="L68">                return (BattingStats) predictions.getSplits(p).getVsLeft();</span>
            }

            public BattingRatings getRatings(Player p) {
<span class="nc" id="L72">                return (BattingRatings) p.getBattingRatings().getVsLeft();</span>
            }

<span class="nc" id="L75">            public VsHand getOther() { return VS_RHP; }</span>
        },
<span class="nc" id="L77">        VS_RHP {</span>
            public BattingStats getStats(TeamStats&lt;BattingStats&gt; predictions, Player p) {
<span class="nc" id="L79">                SplitStats&lt;BattingStats&gt; splits = predictions.getSplits(p);</span>

<span class="nc" id="L81">                Preconditions.checkNotNull(splits, &quot;Expected to find splits for %s&quot;, p.getShortName());</span>

<span class="nc" id="L83">                return splits.getVsRight();</span>
            }

            public BattingRatings getRatings(Player p) {
<span class="nc" id="L87">                return (BattingRatings) p.getBattingRatings().getVsRight();</span>
            }

<span class="nc" id="L90">            public VsHand getOther() { return VS_LHP; }</span>
        };

        public abstract BattingStats getStats(TeamStats&lt;BattingStats&gt; teamstats, Player player);

        public abstract BattingRatings getRatings(Player player);

        public abstract VsHand getOther();
    }

<span class="nc" id="L100">    public Lineup() { }</span>

    public void setOrder(Iterable ps) {
<span class="nc" id="L103">        order = ImmutableList.copyOf(ps);</span>
<span class="nc" id="L104">    }</span>

    public void setDefense(Defense defense) {
<span class="nc" id="L107">        this.defense = defense;</span>
<span class="nc" id="L108">    }</span>

    public Entry getEntry(int entry) {
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (entry &gt;= order.size()) {</span>
<span class="nc" id="L112">            return new Entry(Position.PITCHER, null);</span>
        } else {
<span class="nc" id="L114">            Player p = order.get(entry);</span>
<span class="nc" id="L115">            return new Entry(getPosition(p), p);</span>
        }
    }

    public Iterator&lt;Entry&gt; iterator() {
<span class="nc" id="L120">        return Lists</span>
<span class="nc" id="L121">            .transform(</span>
<span class="nc" id="L122">                ImmutableList.of(0, 1, 2, 3, 4, 5, 6, 7, 8),</span>
<span class="nc" id="L123">                new Function&lt;Integer, Entry&gt;() {</span>
                    public Entry apply(Integer i) {
<span class="nc" id="L125">                        return getEntry(i);</span>
                    }
                })
<span class="nc" id="L128">            .iterator();</span>
    }

    public Boolean contains(Player p) {
<span class="nc" id="L132">        return order.contains(p);</span>
    }

    public Set&lt;Player&gt; playerSet() {
<span class="nc" id="L136">        return ImmutableSet.copyOf(order);</span>
    }

    public Position getPosition(Player p) {
<span class="nc bnc" id="L140" title="All 2 branches missed.">        return defense.contains(p)  ? defense.getPosition(p) : Position.DESIGNATED_HITTER;</span>
    }

    @Override
    public void print(PrintWriter w) {
<span class="nc" id="L145">        int idx = 1;</span>
<span class="nc bnc" id="L146" title="All 2 branches missed.">        for (Player p : order) {</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">            String pos = defense.contains(p) ? defense.getPosition(p).getAbbreviation() : &quot;DH&quot;;</span>
<span class="nc" id="L148">            w.format(&quot;%d. %2s %-15s%n&quot;, idx, pos, p.getShortName());</span>
<span class="nc" id="L149">            idx++;</span>
<span class="nc" id="L150">        }</span>

<span class="nc bnc" id="L152" title="All 2 branches missed.">        if (idx &lt; 10) {</span>
<span class="nc" id="L153">            w.println(&quot;9.  P&quot;);</span>
        }
<span class="nc" id="L155">        w.flush();</span>
<span class="nc" id="L156">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>